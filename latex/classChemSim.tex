\hypertarget{classChemSim}{\section{Chem\+Sim Class Reference}
\label{classChemSim}\index{Chem\+Sim@{Chem\+Sim}}
}


Used to manage running a network of chemical reactions.  




{\ttfamily \#include $<$Chem\+Sim.\+h$>$}



Collaboration diagram for Chem\+Sim\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=159pt]{classChemSim__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classChemSim_a4b06224f48b2c5ef649a177931ecd5f6}{Chem\+Sim} (const \hyperlink{classChemSim}{Chem\+Sim} \&rhs)=delete
\begin{DoxyCompactList}\small\item\em Copying is not allowed. \end{DoxyCompactList}\item 
\hyperlink{classChemSim}{Chem\+Sim} \& \hyperlink{classChemSim_aeb69f4407d4ae03a7e813be403247f7c}{operator=} (\hyperlink{classChemSim}{Chem\+Sim} \&rhs)=delete
\begin{DoxyCompactList}\small\item\em Assignment is not allowed. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{classChemSim_a0f8a949bc07480c36b590128180e56e7}{set\+Instance} (\hyperlink{classChemSimImpl}{Chem\+Sim\+Impl} $\ast$csi)
\begin{DoxyCompactList}\small\item\em Set\+Instance. \end{DoxyCompactList}\item 
static void \hyperlink{classChemSim_affbdef9382a7c693a08f03f19e60d7fb}{initialize} ()
\begin{DoxyCompactList}\small\item\em After all initial reactions have been added via add\+Reaction(...) method, invoke \hyperlink{classChemSim_affbdef9382a7c693a08f03f19e60d7fb}{initialize()} prior to invoking \hyperlink{classChemSim_a60bf7095bcc35a4865a2bb191b070fc9}{run()} \end{DoxyCompactList}\item 
static void \hyperlink{classChemSim_a7ef2b5545a5250201b96c666b5ba6f92}{add\+Reaction} (\hyperlink{classReactionBase}{Reaction\+Base} $\ast$r)
\begin{DoxyCompactList}\small\item\em Add \hyperlink{classReaction}{Reaction} $\ast$r to the chemical network which needs to be simulated. \end{DoxyCompactList}\item 
static void \hyperlink{classChemSim_aefddf4bedce37ad6d9afef1631df96a1}{remove\+Reaction} (\hyperlink{classReactionBase}{Reaction\+Base} $\ast$r)
\begin{DoxyCompactList}\small\item\em Remove \hyperlink{classReaction}{Reaction} $\ast$r from the simulated chemical network. \end{DoxyCompactList}\item 
static bool \hyperlink{classChemSim_a60bf7095bcc35a4865a2bb191b070fc9}{run} (int steps)
\begin{DoxyCompactList}\small\item\em Run the chemical dynamics for a specific number of steps. \end{DoxyCompactList}\item 
static void \hyperlink{classChemSim_acc1d8030a587b1996d18c0ea775c34f0}{print\+Reactions} ()
\begin{DoxyCompactList}\small\item\em Mainly used for debugging\+: print chemical reactions in the network at this moment. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classChemSim_a7a14b6058861d217c37f1d1f43b85db6}{Chem\+Sim} ()
\end{DoxyCompactItemize}
\subsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classChemSimImpl}{Chem\+Sim\+Impl} $\ast$ \hyperlink{classChemSim_a925fca4c4b0e800007163500b8b7909d}{\+\_\+pimpl} = 0
\begin{DoxyCompactList}\small\item\em Store a pointer to a specific implementation of stochastic chemical kinetics; no ownership. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Used to manage running a network of chemical reactions. 

\hyperlink{classChemSim}{Chem\+Sim} implements a Strategy pattern, allowing custom algorithms for running stochastic chemical simulations. It itself is a singleton, with a pointer to a single static implementation of \hyperlink{classChemSimImpl}{Chem\+Sim\+Impl}. After the specific algorithm is chosen and \hyperlink{classChemSim}{Chem\+Sim} is instantiated, \hyperlink{classChemSim}{Chem\+Sim} can be used to manage simulations, through such methods as run(steps) etc. Here is an example (assuming key is valid for all functions)\+: 
\begin{DoxyCode}
\hyperlink{classSpeciesBulk}{SpeciesBulk} A1(\textcolor{stringliteral}{"A1"},  25);
\hyperlink{classSpeciesBulk}{SpeciesBulk} A2(\textcolor{stringliteral}{"A2"}, 25);
\hyperlink{classReaction}{Reaction} r1 = \{ \{&A1,&A2\}, 1, 1, 100.0 \};
\hyperlink{classChemSim_a0f8a949bc07480c36b590128180e56e7}{ChemSim::setInstance}(key, \textcolor{keyword}{new} \hyperlink{classChemNRMImpl}{ChemNRMImpl}());
\hyperlink{classChemSim_a7ef2b5545a5250201b96c666b5ba6f92}{ChemSim::addReaction}(key, &r1);
\hyperlink{classChemSim_affbdef9382a7c693a08f03f19e60d7fb}{ChemSim::initialize}(key);
\hyperlink{classChemSim_a60bf7095bcc35a4865a2bb191b070fc9}{ChemSim::run}(key)
\end{DoxyCode}


Specific functions in this class require a key to be accessed. The key declarations are above. These keys can only be created and/or destroyed by the classes that are \char`\"{}friends\char`\"{} with the key. 

Definition at line 44 of file Chem\+Sim.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classChemSim_a4b06224f48b2c5ef649a177931ecd5f6}{\index{Chem\+Sim@{Chem\+Sim}!Chem\+Sim@{Chem\+Sim}}
\index{Chem\+Sim@{Chem\+Sim}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{Chem\+Sim}]{\setlength{\rightskip}{0pt plus 5cm}Chem\+Sim\+::\+Chem\+Sim (
\begin{DoxyParamCaption}
\item[{const {\bf Chem\+Sim} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [delete]}}}\label{classChemSim_a4b06224f48b2c5ef649a177931ecd5f6}


Copying is not allowed. 

\hypertarget{classChemSim_a7a14b6058861d217c37f1d1f43b85db6}{\index{Chem\+Sim@{Chem\+Sim}!Chem\+Sim@{Chem\+Sim}}
\index{Chem\+Sim@{Chem\+Sim}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{Chem\+Sim}]{\setlength{\rightskip}{0pt plus 5cm}Chem\+Sim\+::\+Chem\+Sim (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}}\label{classChemSim_a7a14b6058861d217c37f1d1f43b85db6}


Definition at line 75 of file Chem\+Sim.\+h.



\subsection{Member Function Documentation}
\hypertarget{classChemSim_a7ef2b5545a5250201b96c666b5ba6f92}{\index{Chem\+Sim@{Chem\+Sim}!add\+Reaction@{add\+Reaction}}
\index{add\+Reaction@{add\+Reaction}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{add\+Reaction}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Sim\+::add\+Reaction (
\begin{DoxyParamCaption}
\item[{{\bf Reaction\+Base} $\ast$}]{r}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classChemSim_a7ef2b5545a5250201b96c666b5ba6f92}


Add \hyperlink{classReaction}{Reaction} $\ast$r to the chemical network which needs to be simulated. 



Definition at line 26 of file Chem\+Sim.\+cpp.



References \+\_\+pimpl, and Chem\+Sim\+Impl\+::add\+Reaction().



Referenced by Compartment\+Grid\+::add\+Chem\+Sim\+Reactions(), Compartment\+::add\+Chem\+Sim\+Reactions(), C\+Cylinder\+::add\+Cross\+Cylinder\+Reaction(), C\+Cylinder\+::add\+Internal\+Reaction(), and main().

\hypertarget{classChemSim_affbdef9382a7c693a08f03f19e60d7fb}{\index{Chem\+Sim@{Chem\+Sim}!initialize@{initialize}}
\index{initialize@{initialize}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{initialize}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Sim\+::initialize (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classChemSim_affbdef9382a7c693a08f03f19e60d7fb}


After all initial reactions have been added via add\+Reaction(...) method, invoke \hyperlink{classChemSim_affbdef9382a7c693a08f03f19e60d7fb}{initialize()} prior to invoking \hyperlink{classChemSim_a60bf7095bcc35a4865a2bb191b070fc9}{run()} 



Definition at line 38 of file Chem\+Sim.\+cpp.



References \+\_\+pimpl, and Chem\+Sim\+Impl\+::initialize().



Referenced by C\+Controller\+::initialize(), and main().

\hypertarget{classChemSim_aeb69f4407d4ae03a7e813be403247f7c}{\index{Chem\+Sim@{Chem\+Sim}!operator=@{operator=}}
\index{operator=@{operator=}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{operator=}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Chem\+Sim}\& Chem\+Sim\+::operator= (
\begin{DoxyParamCaption}
\item[{{\bf Chem\+Sim} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [delete]}}}\label{classChemSim_aeb69f4407d4ae03a7e813be403247f7c}


Assignment is not allowed. 

\hypertarget{classChemSim_acc1d8030a587b1996d18c0ea775c34f0}{\index{Chem\+Sim@{Chem\+Sim}!print\+Reactions@{print\+Reactions}}
\index{print\+Reactions@{print\+Reactions}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{print\+Reactions}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Sim\+::print\+Reactions (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classChemSim_acc1d8030a587b1996d18c0ea775c34f0}


Mainly used for debugging\+: print chemical reactions in the network at this moment. 



Definition at line 42 of file Chem\+Sim.\+cpp.



References \+\_\+pimpl, and Chem\+Sim\+Impl\+::print\+Reactions().



Referenced by main().

\hypertarget{classChemSim_aefddf4bedce37ad6d9afef1631df96a1}{\index{Chem\+Sim@{Chem\+Sim}!remove\+Reaction@{remove\+Reaction}}
\index{remove\+Reaction@{remove\+Reaction}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{remove\+Reaction}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Sim\+::remove\+Reaction (
\begin{DoxyParamCaption}
\item[{{\bf Reaction\+Base} $\ast$}]{r}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classChemSim_aefddf4bedce37ad6d9afef1631df96a1}


Remove \hyperlink{classReaction}{Reaction} $\ast$r from the simulated chemical network. 



Definition at line 30 of file Chem\+Sim.\+cpp.



References \+\_\+pimpl, and Chem\+Sim\+Impl\+::remove\+Reaction().



Referenced by C\+Cylinder\+::remove\+All\+Cross\+Cylinder\+Reactions(), C\+Cylinder\+::remove\+All\+Internal\+Reactions(), C\+Cylinder\+::remove\+Cross\+Cylinder\+Reactions(), and C\+Cylinder\+::remove\+Internal\+Reaction().

\hypertarget{classChemSim_a60bf7095bcc35a4865a2bb191b070fc9}{\index{Chem\+Sim@{Chem\+Sim}!run@{run}}
\index{run@{run}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{run}]{\setlength{\rightskip}{0pt plus 5cm}bool Chem\+Sim\+::run (
\begin{DoxyParamCaption}
\item[{int}]{steps}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classChemSim_a60bf7095bcc35a4865a2bb191b070fc9}


Run the chemical dynamics for a specific number of steps. 



Definition at line 34 of file Chem\+Sim.\+cpp.



References \+\_\+pimpl, and Chem\+Sim\+Impl\+::run().



Referenced by main(), and C\+Controller\+::run().

\hypertarget{classChemSim_a0f8a949bc07480c36b590128180e56e7}{\index{Chem\+Sim@{Chem\+Sim}!set\+Instance@{set\+Instance}}
\index{set\+Instance@{set\+Instance}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{set\+Instance}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Sim\+::set\+Instance (
\begin{DoxyParamCaption}
\item[{{\bf Chem\+Sim\+Impl} $\ast$}]{csi}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classChemSim_a0f8a949bc07480c36b590128180e56e7}


Set\+Instance. 


\begin{DoxyParams}{Parameters}
{\em \hyperlink{classChemSimImpl}{Chem\+Sim\+Impl}} & $\ast$csi is a pointer the concrete implementation of stochastic simulation algorithm. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
\hyperlink{classChemSim}{Chem\+Sim} simply stores the csi pointer but does not manage its memory. Make sure that csi is always a valid pointer while \hyperlink{classChemSim}{Chem\+Sim} is used. 
\end{DoxyNote}


Definition at line 20 of file Chem\+Sim.\+cpp.



References \+\_\+pimpl.



Referenced by C\+Controller\+::initialize().



\subsection{Member Data Documentation}
\hypertarget{classChemSim_a925fca4c4b0e800007163500b8b7909d}{\index{Chem\+Sim@{Chem\+Sim}!\+\_\+pimpl@{\+\_\+pimpl}}
\index{\+\_\+pimpl@{\+\_\+pimpl}!Chem\+Sim@{Chem\+Sim}}
\subsubsection[{\+\_\+pimpl}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Chem\+Sim\+Impl} $\ast$ Chem\+Sim\+::\+\_\+pimpl = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}}\label{classChemSim_a925fca4c4b0e800007163500b8b7909d}


Store a pointer to a specific implementation of stochastic chemical kinetics; no ownership. 



Definition at line 74 of file Chem\+Sim.\+h.



Referenced by add\+Reaction(), initialize(), print\+Reactions(), remove\+Reaction(), run(), and set\+Instance().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
M3\+S\+Y\+M/\+Chemistry/\hyperlink{ChemSim_8h}{Chem\+Sim.\+h}\item 
M3\+S\+Y\+M/\+Chemistry/\hyperlink{ChemSim_8cpp}{Chem\+Sim.\+cpp}\end{DoxyCompactItemize}
