\hypertarget{classChemGillespieImpl}{\section{Chem\+Gillespie\+Impl Class Reference}
\label{classChemGillespieImpl}\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
}


Implements a slightly optimized version of the Gillespie algorithm.  




{\ttfamily \#include $<$Chem\+Gillespie\+Impl.\+h$>$}



Inheritance diagram for Chem\+Gillespie\+Impl\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=180pt]{classChemGillespieImpl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Chem\+Gillespie\+Impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classChemGillespieImpl__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classChemGillespieImpl_a262281b68b8fdd026a8d28f57315b13d}{Chem\+Gillespie\+Impl} ()
\begin{DoxyCompactList}\small\item\em Ctor\+: Seeds the random number generator, sets global time to 0.\+0 and the number of reactions to 0. \end{DoxyCompactList}\item 
\hyperlink{classChemGillespieImpl_aa492ec3985b18a49352c47d8d12c3647}{Chem\+Gillespie\+Impl} (const \hyperlink{classChemGillespieImpl}{Chem\+Gillespie\+Impl} \&rhs)=delete
\begin{DoxyCompactList}\small\item\em Copying is not allowed. \end{DoxyCompactList}\item 
\hyperlink{classChemGillespieImpl}{Chem\+Gillespie\+Impl} \& \hyperlink{classChemGillespieImpl_a1c0c24205d43a0f70be04ead713d18f9}{operator=} (\hyperlink{classChemGillespieImpl}{Chem\+Gillespie\+Impl} \&rhs)=delete
\begin{DoxyCompactList}\small\item\em Assignment is not allowed. \end{DoxyCompactList}\item 
virtual \hyperlink{classChemGillespieImpl_a56b73cf9e60b5ebd9ead82d4b6dd1b1a}{$\sim$\+Chem\+Gillespie\+Impl} () noexcept
\begin{DoxyCompactList}\small\item\em Dtor\+: The reaction network is cleared. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{classChemGillespieImpl_a8deb307599919a7a2f8d597245761fdd}{get\+Size} () const 
\begin{DoxyCompactList}\small\item\em Return the number of reactions in the network. \end{DoxyCompactList}\item 
double \hyperlink{classChemGillespieImpl_a8295735915237bae30d18cd6c31c058a}{get\+Time} () const 
\begin{DoxyCompactList}\small\item\em Return the current global time (as defined in the Gillespie algorithm) \end{DoxyCompactList}\item 
void \hyperlink{classChemGillespieImpl_a21fcdf4c1f9c8372ebf292c5b4006b4a}{reset\+Time} ()
\begin{DoxyCompactList}\small\item\em Sets the global time to 0.\+0. \end{DoxyCompactList}\item 
void \hyperlink{classChemGillespieImpl_ae1fb14fb7f6eaa6a3ce21c8917de4624}{sync\+Global\+Time} ()
\begin{DoxyCompactList}\small\item\em Sets global time variable to \hyperlink{classChemGillespieImpl}{Chem\+Gillespie\+Impl}'s global time. \end{DoxyCompactList}\item 
virtual void \hyperlink{classChemGillespieImpl_afc2764e90e24e70b48577525421815c0}{add\+Reaction} (\hyperlink{classReactionBase}{Reaction\+Base} $\ast$r)
\begin{DoxyCompactList}\small\item\em Add \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r to the network. \end{DoxyCompactList}\item 
virtual void \hyperlink{classChemGillespieImpl_ad818d065b15a17427793ab099ee987a8}{remove\+Reaction} (\hyperlink{classReactionBase}{Reaction\+Base} $\ast$r)
\begin{DoxyCompactList}\small\item\em Remove \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r from the network. \end{DoxyCompactList}\item 
double \hyperlink{classChemGillespieImpl_a9a5292f5ede270611175f2061ef5d2c1}{compute\+Total\+A} ()
\begin{DoxyCompactList}\small\item\em Unconditionally compute the total propensity associated with the network. \end{DoxyCompactList}\item 
double \hyperlink{classChemGillespieImpl_ae2a584042f976aa39399b700011abe43}{generate\+Tau} (double a)
\begin{DoxyCompactList}\small\item\em Returns a random time tau, drawn from the exponential distribution, with the propensity given by a. \end{DoxyCompactList}\item 
double \hyperlink{classChemGillespieImpl_a165ea88d8e31bbd994f6b81a4ceda67e}{generate\+Uniform} ()
\begin{DoxyCompactList}\small\item\em Returns a random number between 0 and 1, drawn from the uniform distribution. \end{DoxyCompactList}\item 
virtual void \hyperlink{classChemGillespieImpl_a4362f0c7944ab1f6b07d43a2efbe8951}{initialize} ()
\begin{DoxyCompactList}\small\item\em This function iterates over all \hyperlink{classRNodeGillespie}{R\+Node\+Gillespie} objects in the network, activating all \hyperlink{classReaction}{Reaction} objects and calling reset(). \end{DoxyCompactList}\item 
virtual bool \hyperlink{classChemGillespieImpl_a1db4057b9cc7f51c2c8e3d880349f8a3}{run} (int steps)
\begin{DoxyCompactList}\small\item\em This method runs the Gillespie algorithm for the given number of steps. \end{DoxyCompactList}\item 
void \hyperlink{classChemGillespieImpl_aefbeeeb2edf0d6726cf50c129e320e58}{activate\+Reaction} (\hyperlink{classReactionBase}{Reaction\+Base} $\ast$r)
\begin{DoxyCompactList}\small\item\em This method is used to track the change in the total propensity of the network as the previously passivated \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r has become activated. \end{DoxyCompactList}\item 
void \hyperlink{classChemGillespieImpl_a5916a11b71b642edee290af9fc969b28}{passivate\+Reaction} (\hyperlink{classReactionBase}{Reaction\+Base} $\ast$r)
\begin{DoxyCompactList}\small\item\em This method is used to track the change in the total propensity of the network as the \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r has become passivated. \end{DoxyCompactList}\item 
virtual void \hyperlink{classChemGillespieImpl_a389502576c64b5c4454a79c4b6ccd4b2}{print\+Reactions} () const 
\begin{DoxyCompactList}\small\item\em Prints all R\+Nodes in the reaction network. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classChemGillespieImpl_a4474dce6c1c9074569cbdf75a991f82a}{make\+Step} ()
\begin{DoxyCompactList}\small\item\em This subroutine, along with with \hyperlink{classChemGillespieImpl_a5916a11b71b642edee290af9fc969b28}{passivate\+Reaction()} and \hyperlink{classChemGillespieImpl_aefbeeeb2edf0d6726cf50c129e320e58}{activate\+Reaction()} implements a cached version of the Gillespie algorith. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
unordered\+\_\+map$<$ \hyperlink{classReactionBase}{Reaction\+Base} \\*
$\ast$, unique\+\_\+ptr$<$ \hyperlink{classRNodeGillespie}{R\+Node\+Gillespie} $>$ $>$ \hyperlink{classChemGillespieImpl_ab8d6bcef48ea219a249cebdb436dbc30}{\+\_\+map\+\_\+rnodes}
\begin{DoxyCompactList}\small\item\em The database of \hyperlink{classRNodeGillespie}{R\+Node\+Gillespie} objects, representing the reaction network. \end{DoxyCompactList}\item 
mt19937 \hyperlink{classChemGillespieImpl_a27162663b9cf776971f2f32483c6fe95}{\+\_\+eng}
\begin{DoxyCompactList}\small\item\em Random number generator. \end{DoxyCompactList}\item 
exponential\+\_\+distribution$<$ double $>$ \hyperlink{classChemGillespieImpl_a6ea99580ca00386e7db98a4059fbed0c}{\+\_\+exp\+\_\+distr}
\begin{DoxyCompactList}\small\item\em Adaptor for the exponential distribution. \end{DoxyCompactList}\item 
uniform\+\_\+real\+\_\+distribution$<$ double $>$ \hyperlink{classChemGillespieImpl_a6d37367996fad3157b63e6750ce6569b}{\+\_\+uniform\+\_\+distr}
\item 
double \hyperlink{classChemGillespieImpl_ab709229380a7bd5458d6c4b382036a7a}{\+\_\+t}
\begin{DoxyCompactList}\small\item\em global time \end{DoxyCompactList}\item 
double \hyperlink{classChemGillespieImpl_aeec18c37a7c9ad88199a78d613e7f8ac}{\+\_\+a\+\_\+total}
\item 
size\+\_\+t \hyperlink{classChemGillespieImpl_ae66f4f44055f9af574bd334f78f92393}{\+\_\+n\+\_\+reacts}
\begin{DoxyCompactList}\small\item\em number of reactions in the network \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Implements a slightly optimized version of the Gillespie algorithm. 

\hyperlink{classChemGillespieImpl}{Chem\+Gillespie\+Impl} manages the Gillespie algorithm at the level of the network of reactions. \hyperlink{classReaction}{Reaction} objects can be added and removed from the \hyperlink{classChemGillespieImpl}{Chem\+Gillespie\+Impl} instance. The propensities of all Reactions are cached, and they are recomputed only when the copy number of associated reactant species gets changed (due to the currently occurring \hyperlink{classReaction}{Reaction}). \begin{DoxyNote}{Note}
The algorithm used by this class relies on tracking dependent Reactions, so T\+R\+A\+C\+K\+\_\+\+D\+E\+P\+E\+N\+D\+E\+N\+T\+S must be defined. The algorithm can work both when T\+R\+A\+C\+K\+\_\+\+Z\+E\+R\+O\+\_\+\+C\+O\+P\+Y\+\_\+\+N and T\+R\+A\+C\+K\+\_\+\+U\+P\+P\+E\+R\+\_\+\+C\+O\+P\+Y\+\_\+\+N are either defined or undefined. In the former case, \hyperlink{classReaction}{Reaction} objects with zero propensities stop being treated as dependents until their propensities become nonzero again. 
\end{DoxyNote}


Definition at line 125 of file Chem\+Gillespie\+Impl.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classChemGillespieImpl_a262281b68b8fdd026a8d28f57315b13d}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{Chem\+Gillespie\+Impl}]{\setlength{\rightskip}{0pt plus 5cm}Chem\+Gillespie\+Impl\+::\+Chem\+Gillespie\+Impl (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classChemGillespieImpl_a262281b68b8fdd026a8d28f57315b13d}


Ctor\+: Seeds the random number generator, sets global time to 0.\+0 and the number of reactions to 0. 



Definition at line 128 of file Chem\+Gillespie\+Impl.\+h.



References reset\+Time().

\hypertarget{classChemGillespieImpl_aa492ec3985b18a49352c47d8d12c3647}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{Chem\+Gillespie\+Impl}]{\setlength{\rightskip}{0pt plus 5cm}Chem\+Gillespie\+Impl\+::\+Chem\+Gillespie\+Impl (
\begin{DoxyParamCaption}
\item[{const {\bf Chem\+Gillespie\+Impl} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [delete]}}}\label{classChemGillespieImpl_aa492ec3985b18a49352c47d8d12c3647}


Copying is not allowed. 

\hypertarget{classChemGillespieImpl_a56b73cf9e60b5ebd9ead82d4b6dd1b1a}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!````~Chem\+Gillespie\+Impl@{$\sim$\+Chem\+Gillespie\+Impl}}
\index{````~Chem\+Gillespie\+Impl@{$\sim$\+Chem\+Gillespie\+Impl}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{$\sim$\+Chem\+Gillespie\+Impl}]{\setlength{\rightskip}{0pt plus 5cm}Chem\+Gillespie\+Impl\+::$\sim$\+Chem\+Gillespie\+Impl (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [noexcept]}}}\label{classChemGillespieImpl_a56b73cf9e60b5ebd9ead82d4b6dd1b1a}


Dtor\+: The reaction network is cleared. 

The \hyperlink{classRNodeGillespie}{R\+Node\+Gillespie} objects will be destructed, but \hyperlink{classReaction}{Reaction} objects will stay intact. \begin{DoxyNote}{Note}
noexcept is important here. Otherwise, gcc flags the constructor as potentially throwing, which in turn disables move operations by the S\+T\+L containers. This behaviour is a gcc bug (as of gcc 4.\+703), and will presumbaly be fixed in the future. 
\end{DoxyNote}


Definition at line 62 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+map\+\_\+rnodes.



\subsection{Member Function Documentation}
\hypertarget{classChemGillespieImpl_aefbeeeb2edf0d6726cf50c129e320e58}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!activate\+Reaction@{activate\+Reaction}}
\index{activate\+Reaction@{activate\+Reaction}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{activate\+Reaction}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::activate\+Reaction (
\begin{DoxyParamCaption}
\item[{{\bf Reaction\+Base} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{classChemGillespieImpl_aefbeeeb2edf0d6726cf50c129e320e58}


This method is used to track the change in the total propensity of the network as the previously passivated \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r has become activated. 



Definition at line 162 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+a\+\_\+total, \+\_\+map\+\_\+rnodes, R\+Node\+Gillespie\+::get\+Penult\+Step\+Propensity(), R\+Node\+Gillespie\+::get\+Propensity(), and R\+Node\+Gillespie\+::re\+Compute\+Propensity().



Referenced by R\+Node\+Gillespie\+::activate\+Reaction().

\hypertarget{classChemGillespieImpl_afc2764e90e24e70b48577525421815c0}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!add\+Reaction@{add\+Reaction}}
\index{add\+Reaction@{add\+Reaction}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{add\+Reaction}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::add\+Reaction (
\begin{DoxyParamCaption}
\item[{{\bf Reaction\+Base} $\ast$}]{r}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classChemGillespieImpl_afc2764e90e24e70b48577525421815c0}


Add \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r to the network. 



Implements \hyperlink{classChemSimImpl_ae1ca0468b4564703d87d69f45ee6e1f9}{Chem\+Sim\+Impl}.



Definition at line 145 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+map\+\_\+rnodes, and \+\_\+n\+\_\+reacts.

\hypertarget{classChemGillespieImpl_a9a5292f5ede270611175f2061ef5d2c1}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!compute\+Total\+A@{compute\+Total\+A}}
\index{compute\+Total\+A@{compute\+Total\+A}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{compute\+Total\+A}]{\setlength{\rightskip}{0pt plus 5cm}double Chem\+Gillespie\+Impl\+::compute\+Total\+A (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classChemGillespieImpl_a9a5292f5ede270611175f2061ef5d2c1}


Unconditionally compute the total propensity associated with the network. 



Definition at line 76 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+map\+\_\+rnodes.



Referenced by initialize().

\hypertarget{classChemGillespieImpl_ae2a584042f976aa39399b700011abe43}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!generate\+Tau@{generate\+Tau}}
\index{generate\+Tau@{generate\+Tau}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{generate\+Tau}]{\setlength{\rightskip}{0pt plus 5cm}double Chem\+Gillespie\+Impl\+::generate\+Tau (
\begin{DoxyParamCaption}
\item[{double}]{a}
\end{DoxyParamCaption}
)}}\label{classChemGillespieImpl_ae2a584042f976aa39399b700011abe43}


Returns a random time tau, drawn from the exponential distribution, with the propensity given by a. 



Definition at line 66 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+eng, and \+\_\+exp\+\_\+distr.



Referenced by make\+Step().

\hypertarget{classChemGillespieImpl_a165ea88d8e31bbd994f6b81a4ceda67e}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!generate\+Uniform@{generate\+Uniform}}
\index{generate\+Uniform@{generate\+Uniform}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{generate\+Uniform}]{\setlength{\rightskip}{0pt plus 5cm}double Chem\+Gillespie\+Impl\+::generate\+Uniform (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classChemGillespieImpl_a165ea88d8e31bbd994f6b81a4ceda67e}


Returns a random number between 0 and 1, drawn from the uniform distribution. 



Definition at line 72 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+eng, and \+\_\+uniform\+\_\+distr.



Referenced by make\+Step().

\hypertarget{classChemGillespieImpl_a8deb307599919a7a2f8d597245761fdd}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!get\+Size@{get\+Size}}
\index{get\+Size@{get\+Size}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{get\+Size}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t Chem\+Gillespie\+Impl\+::get\+Size (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{classChemGillespieImpl_a8deb307599919a7a2f8d597245761fdd}


Return the number of reactions in the network. 



Definition at line 146 of file Chem\+Gillespie\+Impl.\+h.



References \+\_\+map\+\_\+rnodes.

\hypertarget{classChemGillespieImpl_a8295735915237bae30d18cd6c31c058a}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!get\+Time@{get\+Time}}
\index{get\+Time@{get\+Time}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{get\+Time}]{\setlength{\rightskip}{0pt plus 5cm}double Chem\+Gillespie\+Impl\+::get\+Time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{classChemGillespieImpl_a8295735915237bae30d18cd6c31c058a}


Return the current global time (as defined in the Gillespie algorithm) 



Definition at line 149 of file Chem\+Gillespie\+Impl.\+h.



References \+\_\+t.

\hypertarget{classChemGillespieImpl_a4362f0c7944ab1f6b07d43a2efbe8951}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!initialize@{initialize}}
\index{initialize@{initialize}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{initialize}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::initialize (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classChemGillespieImpl_a4362f0c7944ab1f6b07d43a2efbe8951}


This function iterates over all \hyperlink{classRNodeGillespie}{R\+Node\+Gillespie} objects in the network, activating all \hyperlink{classReaction}{Reaction} objects and calling reset(). 

The total propentsity for the network is computed. \begin{DoxyNote}{Note}
This method needs to be called before calling run(...). 

If somewhere in the middle of simulaiton \hyperlink{classChemGillespieImpl_a4362f0c7944ab1f6b07d43a2efbe8951}{initialize()} is called, it will be analogous to starting the simulation from scratch, except with the \hyperlink{classSpecies}{Species} copy numbers given at that moment in time. The global time is reset to zero again. 
\end{DoxyNote}


Implements \hyperlink{classChemSimImpl_a8050874ed2646d6632ec9df1704c86c4}{Chem\+Sim\+Impl}.



Definition at line 49 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+a\+\_\+total, \+\_\+map\+\_\+rnodes, compute\+Total\+A(), and reset\+Time().

\hypertarget{classChemGillespieImpl_a4474dce6c1c9074569cbdf75a991f82a}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!make\+Step@{make\+Step}}
\index{make\+Step@{make\+Step}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{make\+Step}]{\setlength{\rightskip}{0pt plus 5cm}bool Chem\+Gillespie\+Impl\+::make\+Step (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_a4474dce6c1c9074569cbdf75a991f82a}


This subroutine, along with with \hyperlink{classChemGillespieImpl_a5916a11b71b642edee290af9fc969b28}{passivate\+Reaction()} and \hyperlink{classChemGillespieImpl_aefbeeeb2edf0d6726cf50c129e320e58}{activate\+Reaction()} implements a cached version of the Gillespie algorith. 

Two random numbers get thrown, one for obtaining tau, the time to the next reaction event, and a uniform number to select which \hyperlink{classReaction}{Reaction} has occurred. Instead of computing the total propensity of the network from scratch, the cached value is being modified as \hyperlink{classReaction}{Reaction} events occur. Returns true if successful, and false if the heap is exchausted and there no more reactions to fire 

Definition at line 87 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+a\+\_\+total, \+\_\+map\+\_\+rnodes, \+\_\+t, Reaction\+Base\+::dependents(), generate\+Tau(), generate\+Uniform(), R\+Node\+Gillespie\+::get\+Penult\+Step\+Propensity(), R\+Node\+Gillespie\+::get\+Propensity(), R\+Node\+Gillespie\+::get\+Reaction(), R\+Node\+Gillespie\+::is\+Passivated(), R\+Node\+Gillespie\+::make\+Step(), R\+Node\+Gillespie\+::re\+Compute\+Propensity(), sync\+Global\+Time(), and tau().



Referenced by run().

\hypertarget{classChemGillespieImpl_a1c0c24205d43a0f70be04ead713d18f9}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!operator=@{operator=}}
\index{operator=@{operator=}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{operator=}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Chem\+Gillespie\+Impl}\& Chem\+Gillespie\+Impl\+::operator= (
\begin{DoxyParamCaption}
\item[{{\bf Chem\+Gillespie\+Impl} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [delete]}}}\label{classChemGillespieImpl_a1c0c24205d43a0f70be04ead713d18f9}


Assignment is not allowed. 

\hypertarget{classChemGillespieImpl_a5916a11b71b642edee290af9fc969b28}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!passivate\+Reaction@{passivate\+Reaction}}
\index{passivate\+Reaction@{passivate\+Reaction}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{passivate\+Reaction}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::passivate\+Reaction (
\begin{DoxyParamCaption}
\item[{{\bf Reaction\+Base} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{classChemGillespieImpl_a5916a11b71b642edee290af9fc969b28}


This method is used to track the change in the total propensity of the network as the \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r has become passivated. 



Definition at line 175 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+a\+\_\+total, \+\_\+map\+\_\+rnodes, R\+Node\+Gillespie\+::get\+Propensity(), R\+Node\+Gillespie\+::set\+A(), and R\+Node\+Gillespie\+::set\+Penult\+A().



Referenced by R\+Node\+Gillespie\+::passivate\+Reaction().

\hypertarget{classChemGillespieImpl_a389502576c64b5c4454a79c4b6ccd4b2}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!print\+Reactions@{print\+Reactions}}
\index{print\+Reactions@{print\+Reactions}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{print\+Reactions}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::print\+Reactions (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classChemGillespieImpl_a389502576c64b5c4454a79c4b6ccd4b2}


Prints all R\+Nodes in the reaction network. 



Implements \hyperlink{classChemSimImpl_a1c0d35dbca7647319a27fa7eaff7388b}{Chem\+Sim\+Impl}.



Definition at line 155 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+map\+\_\+rnodes.

\hypertarget{classChemGillespieImpl_ad818d065b15a17427793ab099ee987a8}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!remove\+Reaction@{remove\+Reaction}}
\index{remove\+Reaction@{remove\+Reaction}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{remove\+Reaction}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::remove\+Reaction (
\begin{DoxyParamCaption}
\item[{{\bf Reaction\+Base} $\ast$}]{r}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classChemGillespieImpl_ad818d065b15a17427793ab099ee987a8}


Remove \hyperlink{classReactionBase}{Reaction\+Base} $\ast$r from the network. 



Implements \hyperlink{classChemSimImpl_a2561de21097a1b12bc60bc53a966e9fc}{Chem\+Sim\+Impl}.



Definition at line 150 of file Chem\+Gillespie\+Impl.\+cpp.



References \+\_\+map\+\_\+rnodes, and \+\_\+n\+\_\+reacts.

\hypertarget{classChemGillespieImpl_a21fcdf4c1f9c8372ebf292c5b4006b4a}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!reset\+Time@{reset\+Time}}
\index{reset\+Time@{reset\+Time}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{reset\+Time}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::reset\+Time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classChemGillespieImpl_a21fcdf4c1f9c8372ebf292c5b4006b4a}


Sets the global time to 0.\+0. 



Definition at line 152 of file Chem\+Gillespie\+Impl.\+h.



References \+\_\+t, and sync\+Global\+Time().



Referenced by Chem\+Gillespie\+Impl(), and initialize().

\hypertarget{classChemGillespieImpl_a1db4057b9cc7f51c2c8e3d880349f8a3}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!run@{run}}
\index{run@{run}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{run}]{\setlength{\rightskip}{0pt plus 5cm}virtual bool Chem\+Gillespie\+Impl\+::run (
\begin{DoxyParamCaption}
\item[{int}]{steps}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{classChemGillespieImpl_a1db4057b9cc7f51c2c8e3d880349f8a3}


This method runs the Gillespie algorithm for the given number of steps. 

\begin{DoxyReturn}{Returns}
true if successful. 
\end{DoxyReturn}


Implements \hyperlink{classChemSimImpl_a3472132dc4b356ed76116c40af2a773d}{Chem\+Sim\+Impl}.



Definition at line 182 of file Chem\+Gillespie\+Impl.\+h.



References make\+Step().

\hypertarget{classChemGillespieImpl_ae1fb14fb7f6eaa6a3ce21c8917de4624}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!sync\+Global\+Time@{sync\+Global\+Time}}
\index{sync\+Global\+Time@{sync\+Global\+Time}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{sync\+Global\+Time}]{\setlength{\rightskip}{0pt plus 5cm}void Chem\+Gillespie\+Impl\+::sync\+Global\+Time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classChemGillespieImpl_ae1fb14fb7f6eaa6a3ce21c8917de4624}


Sets global time variable to \hyperlink{classChemGillespieImpl}{Chem\+Gillespie\+Impl}'s global time. 



Definition at line 155 of file Chem\+Gillespie\+Impl.\+h.



References \+\_\+t, and global\+\_\+time.



Referenced by make\+Step(), and reset\+Time().



\subsection{Member Data Documentation}
\hypertarget{classChemGillespieImpl_aeec18c37a7c9ad88199a78d613e7f8ac}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!\+\_\+a\+\_\+total@{\+\_\+a\+\_\+total}}
\index{\+\_\+a\+\_\+total@{\+\_\+a\+\_\+total}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{\+\_\+a\+\_\+total}]{\setlength{\rightskip}{0pt plus 5cm}double Chem\+Gillespie\+Impl\+::\+\_\+a\+\_\+total\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_aeec18c37a7c9ad88199a78d613e7f8ac}


Definition at line 215 of file Chem\+Gillespie\+Impl.\+h.



Referenced by activate\+Reaction(), initialize(), make\+Step(), and passivate\+Reaction().

\hypertarget{classChemGillespieImpl_a27162663b9cf776971f2f32483c6fe95}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!\+\_\+eng@{\+\_\+eng}}
\index{\+\_\+eng@{\+\_\+eng}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{\+\_\+eng}]{\setlength{\rightskip}{0pt plus 5cm}mt19937 Chem\+Gillespie\+Impl\+::\+\_\+eng\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_a27162663b9cf776971f2f32483c6fe95}


Random number generator. 



Definition at line 211 of file Chem\+Gillespie\+Impl.\+h.



Referenced by generate\+Tau(), and generate\+Uniform().

\hypertarget{classChemGillespieImpl_a6ea99580ca00386e7db98a4059fbed0c}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!\+\_\+exp\+\_\+distr@{\+\_\+exp\+\_\+distr}}
\index{\+\_\+exp\+\_\+distr@{\+\_\+exp\+\_\+distr}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{\+\_\+exp\+\_\+distr}]{\setlength{\rightskip}{0pt plus 5cm}exponential\+\_\+distribution$<$double$>$ Chem\+Gillespie\+Impl\+::\+\_\+exp\+\_\+distr\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_a6ea99580ca00386e7db98a4059fbed0c}


Adaptor for the exponential distribution. 



Definition at line 212 of file Chem\+Gillespie\+Impl.\+h.



Referenced by generate\+Tau().

\hypertarget{classChemGillespieImpl_ab8d6bcef48ea219a249cebdb436dbc30}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!\+\_\+map\+\_\+rnodes@{\+\_\+map\+\_\+rnodes}}
\index{\+\_\+map\+\_\+rnodes@{\+\_\+map\+\_\+rnodes}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{\+\_\+map\+\_\+rnodes}]{\setlength{\rightskip}{0pt plus 5cm}unordered\+\_\+map$<${\bf Reaction\+Base}$\ast$, unique\+\_\+ptr$<${\bf R\+Node\+Gillespie}$>$ $>$ Chem\+Gillespie\+Impl\+::\+\_\+map\+\_\+rnodes\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_ab8d6bcef48ea219a249cebdb436dbc30}


The database of \hyperlink{classRNodeGillespie}{R\+Node\+Gillespie} objects, representing the reaction network. 



Definition at line 210 of file Chem\+Gillespie\+Impl.\+h.



Referenced by activate\+Reaction(), add\+Reaction(), compute\+Total\+A(), get\+Size(), initialize(), make\+Step(), passivate\+Reaction(), print\+Reactions(), remove\+Reaction(), and $\sim$\+Chem\+Gillespie\+Impl().

\hypertarget{classChemGillespieImpl_ae66f4f44055f9af574bd334f78f92393}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!\+\_\+n\+\_\+reacts@{\+\_\+n\+\_\+reacts}}
\index{\+\_\+n\+\_\+reacts@{\+\_\+n\+\_\+reacts}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{\+\_\+n\+\_\+reacts}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t Chem\+Gillespie\+Impl\+::\+\_\+n\+\_\+reacts\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_ae66f4f44055f9af574bd334f78f92393}


number of reactions in the network 



Definition at line 216 of file Chem\+Gillespie\+Impl.\+h.



Referenced by add\+Reaction(), and remove\+Reaction().

\hypertarget{classChemGillespieImpl_ab709229380a7bd5458d6c4b382036a7a}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!\+\_\+t@{\+\_\+t}}
\index{\+\_\+t@{\+\_\+t}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{\+\_\+t}]{\setlength{\rightskip}{0pt plus 5cm}double Chem\+Gillespie\+Impl\+::\+\_\+t\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_ab709229380a7bd5458d6c4b382036a7a}


global time 



Definition at line 214 of file Chem\+Gillespie\+Impl.\+h.



Referenced by get\+Time(), make\+Step(), reset\+Time(), and sync\+Global\+Time().

\hypertarget{classChemGillespieImpl_a6d37367996fad3157b63e6750ce6569b}{\index{Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}!\+\_\+uniform\+\_\+distr@{\+\_\+uniform\+\_\+distr}}
\index{\+\_\+uniform\+\_\+distr@{\+\_\+uniform\+\_\+distr}!Chem\+Gillespie\+Impl@{Chem\+Gillespie\+Impl}}
\subsubsection[{\+\_\+uniform\+\_\+distr}]{\setlength{\rightskip}{0pt plus 5cm}uniform\+\_\+real\+\_\+distribution$<$double$>$ Chem\+Gillespie\+Impl\+::\+\_\+uniform\+\_\+distr\hspace{0.3cm}{\ttfamily [private]}}}\label{classChemGillespieImpl_a6d37367996fad3157b63e6750ce6569b}


Definition at line 213 of file Chem\+Gillespie\+Impl.\+h.



Referenced by generate\+Uniform().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
M3\+S\+Y\+M/\+Chemistry/\hyperlink{ChemGillespieImpl_8h}{Chem\+Gillespie\+Impl.\+h}\item 
M3\+S\+Y\+M/\+Chemistry/\hyperlink{ChemGillespieImpl_8cpp}{Chem\+Gillespie\+Impl.\+cpp}\end{DoxyCompactItemize}
