<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CytoSim: CytoSim/Reaction.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="LamellipodiaModel.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">CytoSim
   &#160;<span id="projectnumber">0.05</span>
   </div>
   <div id="projectbrief">Software  for simulating cell&#39;s cytoskeletal dynamics</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('Reaction_8h.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CytoSim/Reaction.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Reaction_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">//  Reaction.h</span>
<a name="l00003"></a>00003 <span class="comment">//  CytoSim-Experimenting</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">//  Created by Garegin Papoian on 4/19/12.</span>
<a name="l00006"></a>00006 <span class="comment">//  Copyright (c) 2012 University of Maryland. All rights reserved.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#ifndef CytoSim_Experimenting_Reaction_h</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define CytoSim_Experimenting_Reaction_h</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="ReactionBase_8h.html">ReactionBase.h</a>&quot;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">namespace </span>chem {
<a name="l00015"></a>00015 
<a name="l00017"></a>00017 
<a name="l00024"></a>00024 <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> M, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> N&gt;
<a name="l00025"></a><a class="code" href="classchem_1_1Reaction.html">00025</a>     <span class="keyword">class </span><a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction</a> : <span class="keyword">public</span> <a class="code" href="classchem_1_1ReactionBase.html" title="ReactionBase class represents an abstract interface for simple chemical Reactions of the form A + B -...">ReactionBase</a> {
<a name="l00026"></a>00026     <span class="keyword">private</span>:
<a name="l00027"></a><a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72">00027</a>         std::array&lt;RSpecies*, M+N&gt; <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>;
<a name="l00028"></a>00028     <span class="keyword">public</span>:
<a name="l00032"></a><a class="code" href="classchem_1_1Reaction.html#af8d2b07836a89ba05c3ba42ff1e1672e">00032</a>         <a class="code" href="classchem_1_1Reaction.html#af8d2b07836a89ba05c3ba42ff1e1672e" title="The main constructor:">Reaction</a>(std::initializer_list&lt;Species*&gt; species, <span class="keywordtype">float</span> rate = 0.0) : <a class="code" href="classchem_1_1ReactionBase.html" title="ReactionBase class represents an abstract interface for simple chemical Reactions of the form A + B -...">ReactionBase</a>(rate)
<a name="l00033"></a>00033         {
<a name="l00034"></a>00034             <span class="comment">//            std::cout &lt;&lt; &quot;Reaction&lt;M,N&gt;(std::initializer_list&lt;Species*&gt; species, float rate) called...&quot; &lt;&lt; std::endl;</span>
<a name="l00035"></a>00035             <a class="code" href="classchem_1_1Reaction.html#a1c045e54c870a3e4cc0fb17b870d16f3" title="An implementation method used by the constructor.">initializeSpecies</a>(species);
<a name="l00036"></a>00036         }
<a name="l00037"></a>00037         
<a name="l00042"></a>00042         <span class="keyword">template</span> &lt;<span class="keyword">typename</span> InputContainer&gt;
<a name="l00043"></a><a class="code" href="classchem_1_1Reaction.html#a267e22a2712987cd6f700f88a841f1ff">00043</a>         <a class="code" href="classchem_1_1Reaction.html#af8d2b07836a89ba05c3ba42ff1e1672e" title="The main constructor:">Reaction</a>(<span class="keyword">const</span> InputContainer &amp;species, <span class="keywordtype">float</span> rate = 0.0) : <a class="code" href="classchem_1_1ReactionBase.html" title="ReactionBase class represents an abstract interface for simple chemical Reactions of the form A + B -...">ReactionBase</a>(rate)
<a name="l00044"></a>00044         {
<a name="l00045"></a>00045             <span class="comment">//            std::cout &lt;&lt; &quot;Reaction&lt;M,N&gt;(const std::vector&lt;Species*&gt; &amp;species, float rate) called...&quot; &lt;&lt; std::endl;</span>
<a name="l00046"></a>00046             <a class="code" href="classchem_1_1Reaction.html#a1c045e54c870a3e4cc0fb17b870d16f3" title="An implementation method used by the constructor.">initializeSpecies</a>(species);
<a name="l00047"></a>00047         }
<a name="l00048"></a>00048         
<a name="l00050"></a>00050         <a class="code" href="classchem_1_1Reaction.html#af8d2b07836a89ba05c3ba42ff1e1672e" title="The main constructor:">Reaction</a> (<span class="keyword">const</span> <a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction</a> &amp;rb) = <span class="keyword">delete</span>;
<a name="l00051"></a>00051         
<a name="l00053"></a>00053         <a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction</a>&amp; <a class="code" href="classchem_1_1Reaction.html#aea2276bdc0b66f5c3d3f890e894de8f9" title="no assignment (including all derived classes)">operator=</a>(<a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction</a> &amp;rb) = <span class="keyword">delete</span>;
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#ifdef BOOST_MEM_POOL</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>
<a name="l00057"></a>00057         <span class="keywordtype">void</span>* operator new(std::size_t <a class="code" href="classchem_1_1ReactionBase.html#a2d93483578ab0d29a2ec09920e7eeb94" title="Returns the total number of RSpecies.">size</a>);
<a name="l00058"></a>00058         
<a name="l00059"></a>00059         <span class="keywordtype">void</span> operator delete(<span class="keywordtype">void</span>* ptr) noexcept;
<a name="l00060"></a>00060 <span class="preprocessor">#endif</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classchem_1_1Reaction.html#a49e439ac62592b6c9bba5ec9ca6a8825">00063</a>         <span class="keyword">virtual</span> <a class="code" href="classchem_1_1Reaction.html#a49e439ac62592b6c9bba5ec9ca6a8825" title="Destructor Tell Rspecies to remove this Reaction from its internal lists if reactions.">~Reaction</a>() noexcept
<a name="l00064"></a>00064         {
<a name="l00065"></a>00065         <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0U; i&lt;M; ++i)
<a name="l00066"></a>00066             <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;removeAsReactant(<span class="keyword">this</span>);
<a name="l00067"></a>00067         <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=M; i&lt;(M+N); ++i)
<a name="l00068"></a>00068             <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;removeAsProduct(<span class="keyword">this</span>);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070         }
<a name="l00071"></a>00071         
<a name="l00075"></a><a class="code" href="classchem_1_1Reaction.html#a541ddbcb6988934f4fba5e16f7520bec">00075</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <a class="code" href="classchem_1_1RSpecies.html" title="RSpecies class represents the reactive aspect of chemical molecules. It tracks their copy number and ...">RSpecies</a>** <a class="code" href="classchem_1_1Reaction.html#a541ddbcb6988934f4fba5e16f7520bec" title="Returns a pointer to the first element of std::array&lt;RSpecies*, M+N&gt; The type of the pointer is RSpec...">rspecies</a>()<span class="keyword"> override </span>{<span class="keywordflow">return</span> &amp;<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[0];}
<a name="l00076"></a>00076         
<a name="l00079"></a><a class="code" href="classchem_1_1Reaction.html#a01859a22b800334a2702426ff501ec30">00079</a>         <span class="keyword">virtual</span> std::vector&lt;ReactionBase*&gt; <a class="code" href="classchem_1_1Reaction.html#a01859a22b800334a2702426ff501ec30" title="Return a list of reactions which rates would be affected if this reaction were to be executed...">getAffectedReactions</a>()<span class="keyword"> override</span>
<a name="l00080"></a>00080 <span class="keyword">        </span>{
<a name="l00081"></a>00081             std::unordered_set&lt;ReactionBase*&gt; rxns;
<a name="l00082"></a>00082             <span class="keywordflow">for</span>(<span class="keyword">auto</span> s : <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>){
<a name="l00083"></a>00083                 <span class="comment">//                std::cout &lt;&lt; &quot;std::vector&lt;ReactionBase*&gt; getAffectedReactions(): &quot; &lt;&lt; *s &lt;&lt; std::endl;</span>
<a name="l00084"></a>00084                 rxns.insert(s-&gt;beginReactantReactions(),s-&gt;endReactantReactions());
<a name="l00085"></a>00085             }
<a name="l00086"></a>00086             <span class="comment">//        std::sort(rxns.begin(),rxns.end());</span>
<a name="l00087"></a>00087             <span class="comment">//        rxns.erase(std::unique(rxns.begin(),rxns.end()), rxns.end());</span>
<a name="l00088"></a>00088             rxns.erase(<span class="keyword">this</span>);
<a name="l00089"></a>00089             <span class="keywordflow">return</span> std::vector&lt;ReactionBase*&gt;(rxns.begin(),rxns.end());
<a name="l00090"></a>00090         }
<a name="l00091"></a>00091         
<a name="l00092"></a>00092     <span class="keyword">protected</span>:
<a name="l00094"></a>00094         <span class="keyword">template</span> &lt;<span class="keyword">typename</span> InputContainer&gt;
<a name="l00095"></a><a class="code" href="classchem_1_1Reaction.html#a1c045e54c870a3e4cc0fb17b870d16f3">00095</a>         <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#a1c045e54c870a3e4cc0fb17b870d16f3" title="An implementation method used by the constructor.">initializeSpecies</a>(<span class="keyword">const</span> InputContainer &amp;species)
<a name="l00096"></a>00096         {
<a name="l00097"></a>00097             assert(species.size()==(M+N) &amp;&amp; <span class="stringliteral">&quot;Reaction&lt;M,N&gt; Ctor: The species number does not match the template M+N&quot;</span>);
<a name="l00098"></a>00098             std::transform(species.begin(),species.end(),<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.begin(),
<a name="l00099"></a>00099                       [](<a class="code" href="classchem_1_1Species.html" title="Species class represents chemical molecules, tracks their copy number and can be used in Reactions...">Species</a> *s){<span class="keywordflow">return</span> &amp;s-&gt;getRSpecies();});
<a name="l00100"></a>00100             
<a name="l00101"></a>00101             <a class="code" href="classchem_1_1ReactionBase.html#a04cda0098d19b2b4a68a6c413c97ed96" title="Pointers to ReactionBase objects that depend on this ReactionBase being executed.">_dependents</a>=<a class="code" href="classchem_1_1Reaction.html#a01859a22b800334a2702426ff501ec30" title="Return a list of reactions which rates would be affected if this reaction were to be executed...">getAffectedReactions</a>();
<a name="l00102"></a>00102             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0U; i&lt;M; ++i)
<a name="l00103"></a>00103                 <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;addAsReactant(<span class="keyword">this</span>);
<a name="l00104"></a>00104             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=M; i&lt;(M+N); ++i)
<a name="l00105"></a>00105                 <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;addAsProduct(<span class="keyword">this</span>);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107         }
<a name="l00108"></a>00108         
<a name="l00110"></a><a class="code" href="classchem_1_1Reaction.html#af3bdc92ce10377c7847855876e6d7875">00110</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classchem_1_1Reaction.html#af3bdc92ce10377c7847855876e6d7875" title="Implementation of getM()">getMImpl</a>()<span class="keyword"> const override </span>{<span class="keywordflow">return</span> M;}
<a name="l00111"></a>00111 
<a name="l00113"></a><a class="code" href="classchem_1_1Reaction.html#ad7170f4e147a955af31831007e9b90e9">00113</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classchem_1_1Reaction.html#ad7170f4e147a955af31831007e9b90e9" title="Implementation of getN()">getNImpl</a>()<span class="keyword"> const override </span>{<span class="keywordflow">return</span> N;}
<a name="l00114"></a>00114 
<a name="l00116"></a><a class="code" href="classchem_1_1Reaction.html#a8457d6c276b11ed0d12a1ff2ef4f9f50">00116</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classchem_1_1Reaction.html#a8457d6c276b11ed0d12a1ff2ef4f9f50" title="Implementation of size()">sizeImpl</a>()<span class="keyword"> const override </span>{<span class="keywordflow">return</span> M+N;}
<a name="l00117"></a>00117 
<a name="l00119"></a><a class="code" href="classchem_1_1Reaction.html#a441aebc6e42ecd5e9bbf08a4523ed340">00119</a>         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classchem_1_1Reaction.html#a441aebc6e42ecd5e9bbf08a4523ed340" title="Implementation of the operator==(...)">is_equal</a>(<span class="keyword">const</span> <a class="code" href="classchem_1_1ReactionBase.html" title="ReactionBase class represents an abstract interface for simple chemical Reactions of the form A + B -...">ReactionBase</a>&amp; other)<span class="keyword"> const override</span>
<a name="l00120"></a>00120 <span class="keyword">        </span>{
<a name="l00121"></a>00121             <span class="keyword">const</span> <a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction&lt;M,N&gt;</a> *a = <span class="keyword">this</span>;
<a name="l00122"></a>00122             <span class="keyword">const</span> <a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction&lt;M,N&gt;</a> *b = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction&lt;M,N&gt;</a>*<span class="keyword">&gt;</span>(&amp;other);
<a name="l00123"></a>00123             <span class="keyword">auto</span> it_pair = std::mismatch(a-&gt;<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.begin(),a-&gt;<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.end(),b-&gt;<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.begin(),
<a name="l00124"></a>00124                                          [](<a class="code" href="classchem_1_1RSpecies.html" title="RSpecies class represents the reactive aspect of chemical molecules. It tracks their copy number and ...">RSpecies</a>* A, <a class="code" href="classchem_1_1RSpecies.html" title="RSpecies class represents the reactive aspect of chemical molecules. It tracks their copy number and ...">RSpecies</a>* B){<span class="keywordflow">return</span> A-&gt;<a class="code" href="classchem_1_1RSpecies.html#a585ae6da09ba09c824aac7a0fcddd748" title="return parent Species as a reference">getSpecies</a>()==B-&gt;getSpecies();});
<a name="l00125"></a>00125             <span class="keywordflow">if</span>(it_pair.first==a-&gt;<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.end())
<a name="l00126"></a>00126                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00127"></a>00127             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00128"></a>00128         }
<a name="l00129"></a>00129         
<a name="l00131"></a><a class="code" href="classchem_1_1Reaction.html#a764121bff008343f73d1bc701dafa9a6">00131</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classchem_1_1Reaction.html#a764121bff008343f73d1bc701dafa9a6" title="Implementation of getProductOfReactants()">getProductOfReactantsImpl</a>()<span class="keyword"> const override</span>
<a name="l00132"></a>00132 <span class="keyword">        </span>{
<a name="l00133"></a>00133             <span class="keywordtype">int</span> prod = 1;
<a name="l00134"></a>00134             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0U; i&lt;M; ++i)
<a name="l00135"></a>00135                 prod*=<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;<a class="code" href="classchem_1_1ReactionBase.html#ade08c8ab247efe988ebfe271b5876b98" title="Returns the number of product RSpecies.">getN</a>();
<a name="l00136"></a>00136             <span class="keywordflow">return</span> prod;
<a name="l00137"></a>00137             
<a name="l00138"></a>00138         }
<a name="l00139"></a>00139 
<a name="l00141"></a><a class="code" href="classchem_1_1Reaction.html#a16c2e5ad0e01e34c5abb6baf7d389841">00141</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">float</span> <a class="code" href="classchem_1_1Reaction.html#a16c2e5ad0e01e34c5abb6baf7d389841" title="Implementation of computePropensity()">computePropensityImpl</a>()<span class="keyword"> const override</span>
<a name="l00142"></a>00142 <span class="keyword">        </span>{
<a name="l00143"></a>00143 <span class="preprocessor">#ifdef TRACK_UPPER_COPY_N</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span>            <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction&lt;M,N&gt;::getProductOfProductsImpl</a>()==0){
<a name="l00145"></a>00145                 <span class="comment">//            std::cout &lt;&lt; &quot;Reaction::computePropensity() for the Reaction, &quot; &lt;&lt; (*this)</span>
<a name="l00146"></a>00146                 <span class="comment">//            &lt;&lt; &quot; will return 0.0&quot;;</span>
<a name="l00147"></a>00147                 <span class="keywordflow">return</span> float(0.0);
<a name="l00148"></a>00148             }
<a name="l00149"></a>00149 <span class="preprocessor">#endif</span>
<a name="l00150"></a>00150 <span class="preprocessor"></span>            <span class="keywordflow">return</span> <a class="code" href="classchem_1_1ReactionBase.html#a787107879dc2a24b789997bac1eb1634" title="the rate for this ReactionBase">_rate</a>*<a class="code" href="classchem_1_1Reaction.html#a764121bff008343f73d1bc701dafa9a6" title="Implementation of getProductOfReactants()">Reaction&lt;M,N&gt;::getProductOfReactantsImpl</a>();
<a name="l00151"></a>00151 <span class="comment">//            int prod = 1;</span>
<a name="l00152"></a>00152 <span class="comment">//            for(auto i=0U; i&lt;M; ++i)</span>
<a name="l00153"></a>00153 <span class="comment">//                prod*=_rspecies[i]-&gt;getN();</span>
<a name="l00154"></a>00154 <span class="comment">//            return _rate*prod;</span>
<a name="l00155"></a>00155         }
<a name="l00156"></a>00156         
<a name="l00158"></a><a class="code" href="classchem_1_1Reaction.html#a1be37929622322dde8fc0efbee50fb36">00158</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classchem_1_1Reaction.html#a1be37929622322dde8fc0efbee50fb36" title="Implementation of getProductOfProducts()">getProductOfProductsImpl</a>()<span class="keyword"> const override</span>
<a name="l00159"></a>00159 <span class="keyword">        </span>{
<a name="l00160"></a>00160 <span class="preprocessor">#ifdef TRACK_UPPER_COPY_N</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>            <span class="keywordtype">int</span> prod = 1;
<a name="l00162"></a>00162             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=M; i&lt;(M+N); ++i){
<a name="l00163"></a>00163                 prod*=<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;getN()-<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;getUpperLimitForN();
<a name="l00164"></a>00164                 <span class="comment">//            std::cout &lt;&lt; &quot;getProductOfProducts(): &quot; &lt;&lt; (*this) &lt;&lt; (*sit)-&gt;getN() &lt;&lt; &quot; &quot; &lt;&lt; (*sit)-&gt;getUpperLimitForN() &lt;&lt; &quot; &quot; &lt;&lt; ((*sit)-&gt;getN()-(*sit)-&gt;getUpperLimitForN()) &lt;&lt; std::endl;</span>
<a name="l00165"></a>00165             }
<a name="l00166"></a>00166             <span class="keywordflow">return</span> prod;
<a name="l00167"></a>00167 <span class="preprocessor">#else</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span>            <span class="keywordflow">return</span> 1;
<a name="l00169"></a>00169 <span class="preprocessor">#endif</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span>        }
<a name="l00171"></a>00171     
<a name="l00173"></a><a class="code" href="classchem_1_1Reaction.html#a1add1afc001452533140c0130ff0e2e3">00173</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classchem_1_1Reaction.html#a1add1afc001452533140c0130ff0e2e3" title="Implementation of containsSpecies()">containsSpeciesImpl</a>(<a class="code" href="classchem_1_1Species.html" title="Species class represents chemical molecules, tracks their copy number and can be used in Reactions...">Species</a> *s)<span class="keyword"> const override</span>
<a name="l00174"></a>00174 <span class="keyword">        </span>{
<a name="l00175"></a>00175             <span class="keyword">auto</span> it = std::find_if(<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.begin(), <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.end(),
<a name="l00176"></a>00176                                    [s](<span class="keyword">const</span> <a class="code" href="classchem_1_1RSpecies.html" title="RSpecies class represents the reactive aspect of chemical molecules. It tracks their copy number and ...">RSpecies</a> *rs){<span class="keywordflow">return</span> (&amp;rs-&gt;getSpecies())==s;});
<a name="l00177"></a>00177             <span class="keywordflow">return</span> it!=<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.end();
<a name="l00178"></a>00178             
<a name="l00179"></a>00179         }
<a name="l00180"></a>00180     
<a name="l00182"></a><a class="code" href="classchem_1_1Reaction.html#ad7aee2091f1da5b1988605b084f6640a">00182</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#ad7aee2091f1da5b1988605b084f6640a" title="Implementation of makeStep()">makeStepImpl</a>()<span class="keyword"> override</span>
<a name="l00183"></a>00183 <span class="keyword">        </span>{
<a name="l00184"></a>00184             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0U; i&lt;M; ++i)
<a name="l00185"></a>00185                 <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;down();
<a name="l00186"></a>00186             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=M; i&lt;(M+N); ++i)
<a name="l00187"></a>00187                 <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;up();
<a name="l00188"></a>00188         }
<a name="l00189"></a>00189 
<a name="l00191"></a>00191         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#a9ce9262242def224e7ed3878e836a5ac" title="Implementation of activateReactionUnconditional()">activateReactionUnconditionalImpl</a>() <span class="keyword">override</span>;
<a name="l00192"></a>00192 
<a name="l00194"></a>00194         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#a691c21e0428d9e5894a6903b5997936f" title="Implementation of passivateReaction()">passivateReactionImpl</a>() <span class="keyword">override</span>;
<a name="l00195"></a>00195         
<a name="l00197"></a><a class="code" href="classchem_1_1Reaction.html#aab3ab648fdbcf495df822a4fbdbcae21">00197</a>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#aab3ab648fdbcf495df822a4fbdbcae21" title="Print information about this reaction to std::ostream.">printToStream</a>(std::ostream&amp; os)<span class="keyword"> const override</span>
<a name="l00198"></a>00198 <span class="keyword">        </span>{
<a name="l00199"></a>00199             <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i=0;
<a name="l00200"></a>00200             <span class="keyword">auto</span> sit = <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.cbegin();
<a name="l00201"></a>00201             <span class="keyword">auto</span> send = sit+M;
<a name="l00202"></a>00202             <span class="keywordflow">for</span> (; sit!=send; ++sit)
<a name="l00203"></a>00203             {
<a name="l00204"></a>00204                 os &lt;&lt; (*sit)-&gt;getFullName() &lt;&lt; <span class="stringliteral">&quot;{&quot;</span> &lt;&lt; (*sit)-&gt;getN() &lt;&lt; <span class="stringliteral">&quot;}&quot;</span>;
<a name="l00205"></a>00205                 <span class="keywordflow">if</span>(i&lt;M-1)
<a name="l00206"></a>00206                 os &lt;&lt; <span class="stringliteral">&quot; + &quot;</span>;
<a name="l00207"></a>00207                 ++i;
<a name="l00208"></a>00208             }
<a name="l00209"></a>00209             os &lt;&lt; <span class="stringliteral">&quot; ---&gt; &quot;</span>;
<a name="l00210"></a>00210             i=0;
<a name="l00211"></a>00211             <span class="keywordflow">for</span> (<span class="keyword">auto</span> sit = send; sit!=<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>.cend(); ++sit)
<a name="l00212"></a>00212             {
<a name="l00213"></a>00213                 os &lt;&lt; (*sit)-&gt;getFullName() &lt;&lt; <span class="stringliteral">&quot;{&quot;</span> &lt;&lt; (*sit)-&gt;getN() &lt;&lt; <span class="stringliteral">&quot;}&quot;</span>;
<a name="l00214"></a>00214                 <span class="keywordflow">if</span>(i&lt;((N-M)-1))
<a name="l00215"></a>00215                     os &lt;&lt; <span class="stringliteral">&quot; + &quot;</span>;
<a name="l00216"></a>00216                 ++i;
<a name="l00217"></a>00217             }
<a name="l00218"></a>00218             os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <span class="stringliteral">&quot;curr_rate = &quot;</span> &lt;&lt; <a class="code" href="classchem_1_1ReactionBase.html#a89e6e678c44a872feb31a6e168eb2612" title="Returns the rate associated with this ReactionBase.">getRate</a>() &lt;&lt; <span class="stringliteral">&quot;, a=&quot;</span> &lt;&lt; <a class="code" href="classchem_1_1ReactionBase.html#a3e91b5d0c44fcb81bb17d2d0fee7947d" title="Compute the ReactionBase propensity that is needed by a Gillespie like algorithm: rate*reactant_1...">computePropensity</a>() &lt;&lt; <span class="stringliteral">&quot;, ReactionBase ptr=&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00219"></a>00219         }
<a name="l00220"></a>00220         
<a name="l00221"></a>00221 <span class="preprocessor">#ifdef RSPECIES_SIGNALING</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 
<a name="l00225"></a><a class="code" href="classchem_1_1Reaction.html#a8320a7d024a3dc0e64280ed96ea08730">00225</a>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#a8320a7d024a3dc0e64280ed96ea08730" title="This method may be called after a makeStep() took place.">broadcastRSpeciesSignals</a>() 
<a name="l00226"></a>00226         {
<a name="l00227"></a>00227             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0U; i&lt;M; ++i)
<a name="l00228"></a>00228             {
<a name="l00229"></a>00229                 <span class="keywordflow">if</span>(<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;<a class="code" href="classchem_1_1ReactionBase.html#a702c23f24431b5f5a4fa63a7fa257654" title="Return true if this RSpecies emits signals on copy number change.">isSignaling</a>())
<a name="l00230"></a>00230                         <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;emitSignal(-1);
<a name="l00231"></a>00231 
<a name="l00232"></a>00232             }
<a name="l00233"></a>00233             <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=M; i&lt;(M+N); ++i)
<a name="l00234"></a>00234             {
<a name="l00235"></a>00235                 <span class="keywordflow">if</span>(<a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;<a class="code" href="classchem_1_1ReactionBase.html#a702c23f24431b5f5a4fa63a7fa257654" title="Return true if this RSpecies emits signals on copy number change.">isSignaling</a>())
<a name="l00236"></a>00236                     <a class="code" href="classchem_1_1Reaction.html#a42e73865e61bfb5b03a4639b571e5d72" title="An array of RSpecies objects (reactants followed by products)">_rspecies</a>[i]-&gt;<a class="code" href="classchem_1_1ReactionBase.html#a10cd8d287497138d981abfd49f2d041e" title="Broadcasts signal indicating that the ReactionBase event has taken place This method is only called b...">emitSignal</a>(+1);
<a name="l00237"></a>00237             }
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239 <span class="preprocessor">#endif</span>
<a name="l00240"></a>00240 <span class="preprocessor"></span>        
<a name="l00242"></a>00242         <span class="keyword">virtual</span> <a class="code" href="classchem_1_1Reaction.html" title="Reaction&lt;M,N&gt; class represents a concrete chemical reaction, such as A + B -&gt; C, where M is the numbe...">Reaction&lt;M,N&gt;</a>* <a class="code" href="classchem_1_1Reaction.html#a26efcc4b38c615c7d63f3fb1cfae070e" title="Implementation of clone()">cloneImpl</a>(<span class="keyword">const</span> <a class="code" href="classchem_1_1SpeciesPtrContainerVector.html">SpeciesPtrContainerVector</a> &amp;spcv) <span class="keyword">override</span>;
<a name="l00243"></a>00243     };
<a name="l00244"></a>00244 
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     
<a name="l00247"></a>00247     
<a name="l00248"></a>00248     
<a name="l00249"></a>00249     
<a name="l00250"></a>00250     
<a name="l00251"></a>00251     
<a name="l00252"></a>00252     
<a name="l00254"></a><a class="code" href="classchem_1_1Reaction.html#ad0245708cd816ceccf686eebaf06353b">00254</a>     <span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code" href="classchem_1_1Reaction.html#a16c2e5ad0e01e34c5abb6baf7d389841" title="Implementation of computePropensity()">Reaction&lt;1,1&gt;::computePropensityImpl</a>()<span class="keyword"> const</span>
<a name="l00255"></a>00255 <span class="keyword">    </span>{
<a name="l00256"></a>00256 <span class="comment">//        std::cout &lt;&lt; &quot;\ntemplate &lt;&gt; float Reaction&lt;1,1&gt;::computePropensityImpl() const: Partial specialization is used. &quot; &lt;&lt; std::endl;</span>
<a name="l00257"></a>00257 <span class="preprocessor">#ifdef TRACK_UPPER_COPY_N</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(_rspecies[1]-&gt;getN()&gt;=_rspecies[1]-&gt;getUpperLimitForN())
<a name="l00259"></a>00259             <span class="keywordflow">return</span> 0;
<a name="l00260"></a>00260 <span class="preprocessor">#endif</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span>        <span class="keywordflow">return</span> _rate*_rspecies[0]-&gt;getN();
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263     
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     
<a name="l00267"></a><a class="code" href="classchem_1_1Reaction.html#ac1ac05b087d53ff5bcc9e5e00e83bb1d">00267</a>     <span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#ad7aee2091f1da5b1988605b084f6640a" title="Implementation of makeStep()">Reaction&lt;1,1&gt;::makeStepImpl</a>()
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269 <span class="comment">//        std::cout &lt;&lt; &quot;\ntemplate &lt;&gt; void Reaction&lt;1,1&gt;::makeStepImpl(): Partial specialization is used. &quot; &lt;&lt; std::endl;</span>
<a name="l00270"></a>00270         _rspecies[0]-&gt;down();
<a name="l00271"></a>00271         _rspecies[1]-&gt;up();
<a name="l00272"></a>00272     }
<a name="l00273"></a>00273     
<a name="l00274"></a>00274 <span class="preprocessor">#ifdef RSPECIES_SIGNALING</span>
<a name="l00275"></a>00275 <span class="preprocessor"></span>
<a name="l00276"></a><a class="code" href="classchem_1_1Reaction.html#afd605803666c03f48ec6db0f2c837fa9">00276</a>     <span class="keyword">template</span> &lt;&gt;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classchem_1_1Reaction.html#a8320a7d024a3dc0e64280ed96ea08730" title="This method may be called after a makeStep() took place.">Reaction&lt;1,1&gt;::broadcastRSpeciesSignals</a>()
<a name="l00277"></a>00277     {
<a name="l00278"></a>00278 <span class="comment">//        std::cout &lt;&lt; &quot;\ntemplate &lt;&gt;  void Reaction&lt;1,1&gt;::broadcastRSpeciesSignals(): Partial specialization is used. &quot; &lt;&lt; std::endl;</span>
<a name="l00279"></a>00279         <span class="keywordflow">if</span>(_rspecies[0]-&gt;isSignaling())
<a name="l00280"></a>00280             _rspecies[0]-&gt;emitSignal(-1);
<a name="l00281"></a>00281         
<a name="l00282"></a>00282         <span class="keywordflow">if</span>(_rspecies[1]-&gt;isSignaling())
<a name="l00283"></a>00283             _rspecies[1]-&gt;emitSignal(+1);
<a name="l00284"></a>00284     }
<a name="l00285"></a>00285 <span class="preprocessor">#endif</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span>
<a name="l00287"></a>00287 } <span class="comment">// end of namespace</span>
<a name="l00288"></a>00288 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="Reaction_8h.html">Reaction.h</a>      </li>

    <li class="footer">Generated on Thu Sep 20 2012 22:48:50 for CytoSim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
